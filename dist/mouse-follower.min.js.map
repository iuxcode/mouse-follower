{"version":3,"file":"mouse-follower.min.js","sources":["../src/index.js"],"sourcesContent":["/*!\r\n * Cuberto Mouse Follower\r\n * https://cuberto.com/\r\n *\r\n * @version 1.1.2\r\n * @author Cuberto, Artem Dordzhiev (Draft)\r\n */\r\n\r\nexport default class MouseFollower {\r\n    /**\r\n     * @typedef {Object} MouseFollowerOptions\r\n     * @property {string|HTMLElement|null} [el] Existed cursor element.\r\n     * @property {string|HTMLElement|null} [container] Cursor container.\r\n     * @property {string} [className] Cursor root element class name.\r\n     * @property {string} [innerClassName] Inner element class name.\r\n     * @property {string} [textClassName] Text element class name.\r\n     * @property {string} [mediaClassName] Media element class name.\r\n     * @property {string} [mediaBoxClassName] Media inner element class name.\r\n     * @property {string} [iconSvgClassName] SVG sprite class name.\r\n     * @property {string} [iconSvgNamePrefix] SVG sprite icon class name prefix.\r\n     * @property {string} [iconSvgSrc] SVG sprite source.\r\n     * @property {string|null} [dataAttr] Name of data attribute for changing cursor state directly in HTML.\r\n     * @property {string} [hiddenState] Hidden state name.\r\n     * @property {string} [textState] Text state name.\r\n     * @property {string} [iconState] Icon state name.\r\n     * @property {string|null} [activeState] Active (mousedown) state name. Set false to disable.\r\n     * @property {string} [mediaState] Media (image/video) state name.\r\n     * @property {Object} [stateDetection] State detection rules.\r\n     * @property {boolean} [visible] Is cursor visible by default.\r\n     * @property {boolean} [visibleOnState] Automatically show/hide cursor when state added.\r\n     * @property {number} [speed] Cursor movement speed.\r\n     * @property {string} [ease] Timing function of cursor movement.\r\n     * @property {boolean} [overwrite] Overwrite or remain cursor position when `mousemove` event happens.\r\n     * @property {number} [skewing] Default skewing factor.\r\n     * @property {number} [skewingText] Skewing effect factor in a text state.\r\n     * @property {number} [skewingIcon] Skewing effect factor in a icon state.\r\n     * @property {number} [skewingMedia] Skewing effect factor in a media (image/video) state.\r\n     * @property {number} [skewingDelta] Skewing effect base delta.\r\n     * @property {number} [skewingDeltaMax] Skew effect max delta.\r\n     * @property {number} [stickDelta] Stick effect delta.\r\n     * @property {number} [showTimeout] Delay before show.\r\n     * @property {boolean} [hideOnLeave] Hide the cursor when mouse leave container.\r\n     * @property {number} [hideTimeout] Delay before hiding. It should be equal to the CSS hide animation time.\r\n     * @property {number[]} [initialPos] Array (x, y) of initial cursor position.\r\n     */\r\n\r\n    /**\r\n     * Register GSAP animation library.\r\n     *\r\n     * @param {gsap} gsap GSAP library.\r\n     */\r\n    static registerGSAP(gsap) {\r\n        MouseFollower.gsap = gsap;\r\n    }\r\n\r\n    /**\r\n     * Create cursor instance.\r\n     *\r\n     * @param {MouseFollowerOptions} [options] Cursor options.\r\n     */\r\n    constructor(options = {}) {\r\n        /** @type {MouseFollowerOptions} **/\r\n        this.options = Object.assign({}, {\r\n            el: null,\r\n            container: document.body,\r\n            className: 'mf-cursor',\r\n            innerClassName: 'mf-cursor-inner',\r\n            textClassName: 'mf-cursor-text',\r\n            mediaClassName: 'mf-cursor-media',\r\n            mediaBoxClassName: 'mf-cursor-media-box',\r\n            iconSvgClassName: 'mf-svgsprite',\r\n            iconSvgNamePrefix: '-',\r\n            iconSvgSrc: '',\r\n            dataAttr: 'cursor',\r\n            hiddenState: '-hidden',\r\n            textState: '-text',\r\n            iconState: '-icon',\r\n            activeState: '-active',\r\n            mediaState: '-media',\r\n            stateDetection: {\r\n                '-pointer': 'a,button',\r\n            },\r\n            visible: true,\r\n            visibleOnState: false,\r\n            speed: 0.55,\r\n            ease: 'expo.out',\r\n            overwrite: true,\r\n            skewing: 0,\r\n            skewingText: 2,\r\n            skewingIcon: 2,\r\n            skewingMedia: 2,\r\n            skewingDelta: 0.001,\r\n            skewingDeltaMax: 0.15,\r\n            stickDelta: 0.15,\r\n            showTimeout: 0,\r\n            hideOnLeave: true,\r\n            hideTimeout: 300,\r\n            hideMediaTimeout: 300,\r\n            initialPos: [-window.innerWidth, -window.innerHeight],\r\n        }, options);\r\n\r\n        if (this.options.visible && options.stateDetection == null) this.options.stateDetection['-hidden'] = 'iframe';\r\n\r\n        this.gsap = MouseFollower.gsap || window.gsap;\r\n        this.el = typeof (this.options.el) === 'string' ?\r\n            document.querySelector(this.options.el) : this.options.el;\r\n        this.container = typeof (this.options.container) === 'string' ?\r\n            document.querySelector(this.options.container) : this.options.container;\r\n        this.skewing = this.options.skewing;\r\n        this.pos = {x: this.options.initialPos[0], y: this.options.initialPos[1]};\r\n        this.vel = {x: 0, y: 0};\r\n        this.event = {};\r\n        this.events = [];\r\n\r\n        this.init();\r\n    }\r\n\r\n    /**\r\n     * Init cursor.\r\n     */\r\n    init() {\r\n        if (!this.el) this.create();\r\n        this.createSetter();\r\n        this.bind();\r\n        this.render(true);\r\n        this.ticker = this.render.bind(this, false);\r\n        this.gsap.ticker.add(this.ticker);\r\n    }\r\n\r\n    /**\r\n     * Create cursor DOM element and append to container.\r\n     */\r\n    create() {\r\n        this.el = document.createElement('div');\r\n        this.el.className = this.options.className;\r\n        this.el.classList.add(this.options.hiddenState);\r\n\r\n        this.inner = document.createElement('div');\r\n        this.inner.className = this.options.innerClassName;\r\n\r\n        this.text = document.createElement('div');\r\n        this.text.className = this.options.textClassName;\r\n\r\n        this.media = document.createElement('div');\r\n        this.media.className = this.options.mediaClassName;\r\n\r\n        this.mediaBox = document.createElement('div');\r\n        this.mediaBox.className = this.options.mediaBoxClassName;\r\n\r\n        this.media.appendChild(this.mediaBox);\r\n        this.inner.appendChild(this.media);\r\n        this.inner.appendChild(this.text);\r\n        this.el.appendChild(this.inner);\r\n        this.container.appendChild(this.el);\r\n    }\r\n\r\n    /**\r\n     * Create GSAP setters.\r\n     */\r\n    createSetter() {\r\n        this.setter = {\r\n            x: this.gsap.quickSetter(this.el, 'x', 'px'),\r\n            y: this.gsap.quickSetter(this.el, 'y', 'px'),\r\n            rotation: this.gsap.quickSetter(this.el, 'rotation', 'deg'),\r\n            scaleX: this.gsap.quickSetter(this.el, 'scaleX'),\r\n            scaleY: this.gsap.quickSetter(this.el, 'scaleY'),\r\n            wc: this.gsap.quickSetter(this.el, 'willChange'),\r\n            inner: {\r\n                rotation: this.gsap.quickSetter(this.inner, 'rotation', 'deg'),\r\n            },\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Create and attach events.\r\n     */\r\n    bind() {\r\n        this.event.mouseleave = () => this.hide();\r\n        this.event.mouseenter = () => this.show();\r\n        this.event.mousedown = () => this.addState(this.options.activeState);\r\n        this.event.mouseup = () => this.removeState(this.options.activeState);\r\n        this.event.mousemoveOnce = () => this.show();\r\n        this.event.mousemove = (e) => {\r\n            this.gsap.to(this.pos, {\r\n                x: this.stick ? this.stick.x - ((this.stick.x - e.clientX) * this.options.stickDelta) : e.clientX,\r\n                y: this.stick ? this.stick.y - ((this.stick.y - e.clientY) * this.options.stickDelta) : e.clientY,\r\n                overwrite: this.options.overwrite,\r\n                ease: this.options.ease,\r\n                duration: this.visible ? this.options.speed : 0,\r\n                onUpdate: () => this.vel = {x: e.clientX - this.pos.x, y: e.clientY - this.pos.y},\r\n            });\r\n        };\r\n        this.event.mouseover = (e) => {\r\n            for (let target = e.target; target && target !== this.container; target = target.parentNode) {\r\n                if (e.relatedTarget && target.contains(e.relatedTarget)) break;\r\n\r\n                for (let state in this.options.stateDetection) {\r\n                    if (target.matches(this.options.stateDetection[state])) this.addState(state);\r\n                }\r\n\r\n                if (this.options.dataAttr) {\r\n                    const params = this.getFromDataset(target);\r\n                    if (params.state) this.addState(params.state);\r\n                    if (params.text) this.setText(params.text);\r\n                    if (params.icon) this.setIcon(params.icon);\r\n                    if (params.img) this.setImg(params.img);\r\n                    if (params.video) this.setVideo(params.video);\r\n                    if (typeof (params.show) !== 'undefined') this.show();\r\n                    if (typeof (params.stick) !== 'undefined') this.setStick(params.stick || target);\r\n                }\r\n            }\r\n        };\r\n        this.event.mouseout = (e) => {\r\n            for (let target = e.target; target && target !== this.container; target = target.parentNode) {\r\n                if (e.relatedTarget && target.contains(e.relatedTarget)) break;\r\n\r\n                for (let state in this.options.stateDetection) {\r\n                    if (target.matches(this.options.stateDetection[state])) this.removeState(state);\r\n                }\r\n\r\n                if (this.options.dataAttr) {\r\n                    const params = this.getFromDataset(target);\r\n                    if (params.state) this.removeState(params.state);\r\n                    if (params.text) this.removeText();\r\n                    if (params.icon) this.removeIcon();\r\n                    if (params.img) this.removeImg();\r\n                    if (params.video) this.removeVideo();\r\n                    if (typeof (params.show) !== 'undefined') this.hide();\r\n                    if (typeof (params.stick) !== 'undefined') this.removeStick();\r\n                }\r\n            }\r\n        };\r\n\r\n        if (this.options.hideOnLeave) {\r\n            this.container.addEventListener('mouseleave', this.event.mouseleave, {passive: true});\r\n        }\r\n        if (this.options.visible) {\r\n            this.container.addEventListener('mouseenter', this.event.mouseenter, {passive: true});\r\n        }\r\n        if (this.options.activeState) {\r\n            this.container.addEventListener('mousedown', this.event.mousedown, {passive: true});\r\n            this.container.addEventListener('mouseup', this.event.mouseup, {passive: true});\r\n        }\r\n        this.container.addEventListener('mousemove', this.event.mousemove, {passive: true});\r\n        if (this.options.visible) {\r\n            this.container.addEventListener('mousemove', this.event.mousemoveOnce, {\r\n                passive: true,\r\n                once: true,\r\n            });\r\n        }\r\n        if (this.options.stateDetection || this.options.dataAttr) {\r\n            this.container.addEventListener('mouseover', this.event.mouseover, {passive: true});\r\n            this.container.addEventListener('mouseout', this.event.mouseout, {passive: true});\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Render the cursor in a new position.\r\n     *\r\n     * @param {boolean} [force=false] Force render.\r\n     */\r\n    render(force) {\r\n        if (force !== true && (this.vel.y === 0 || this.vel.x === 0)) {\r\n            this.setter.wc('auto');\r\n            return;\r\n        }\r\n\r\n        this.trigger('render');\r\n        this.setter.wc('transform');\r\n        this.setter.x(this.pos.x);\r\n        this.setter.y(this.pos.y);\r\n\r\n        if (this.skewing) {\r\n            const distance = Math.sqrt(Math.pow(this.vel.x, 2) + Math.pow(this.vel.y, 2));\r\n            const scale = Math.min(distance * this.options.skewingDelta,\r\n                this.options.skewingDeltaMax) * this.skewing;\r\n            const angle = Math.atan2(this.vel.y, this.vel.x) * 180 / Math.PI;\r\n\r\n            this.setter.rotation(angle);\r\n            this.setter.scaleX(1 + scale);\r\n            this.setter.scaleY(1 - scale);\r\n            this.setter.inner.rotation(-angle);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Show cursor.\r\n     */\r\n    show() {\r\n        this.trigger('show');\r\n        clearInterval(this.visibleInt);\r\n        this.visibleInt = setTimeout(() => {\r\n            this.el.classList.remove(this.options.hiddenState);\r\n            this.visible = true;\r\n            this.render(true);\r\n        }, this.options.showTimeout);\r\n    }\r\n\r\n    /**\r\n     * Hide cursor.\r\n     */\r\n    hide() {\r\n        this.trigger('hide');\r\n        clearInterval(this.visibleInt);\r\n        this.el.classList.add(this.options.hiddenState);\r\n        this.visibleInt = setTimeout(() => this.visible = false, this.options.hideTimeout);\r\n    }\r\n\r\n    /**\r\n     * Toggle cursor.\r\n     *\r\n     * @param {boolean} [force] Force state.\r\n     */\r\n    toggle(force) {\r\n        if (force === true || force !== false && !this.visible) {\r\n            this.show();\r\n        } else {\r\n            this.hide();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add state/states to the cursor.\r\n     *\r\n     * @param {string} state State name.\r\n     */\r\n    addState(state) {\r\n        this.trigger('addState', state);\r\n        if (state === this.options.hiddenState) return this.hide();\r\n        this.el.classList.add(...state.split(' '));\r\n        if (this.options.visibleOnState) this.show();\r\n    }\r\n\r\n    /**\r\n     * Remove state/states from cursor.\r\n     *\r\n     * @param {string} state State name.\r\n     */\r\n    removeState(state) {\r\n        this.trigger('removeState', state);\r\n        if (state === this.options.hiddenState) return this.show();\r\n        this.el.classList.remove(...state.split(' '));\r\n        if (this.options.visibleOnState && this.el.className === this.options.className) this.hide();\r\n    }\r\n\r\n    /**\r\n     * Toggle cursor state.\r\n     *\r\n     * @param {string} state State name.\r\n     * @param {boolean} [force] Force state.\r\n     */\r\n    toggleState(state, force) {\r\n        if (force === true || force !== false && !this.el.classList.contains(state)) {\r\n            this.addState(state);\r\n        } else {\r\n            this.removeState(state);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set factor of skewing effect.\r\n     *\r\n     * @param {number} value Skewing factor.\r\n     */\r\n    setSkewing(value) {\r\n        this.gsap.to(this, {skewing: value});\r\n    }\r\n\r\n    /**\r\n     * Reverts skewing factor to default.\r\n     */\r\n    removeSkewing() {\r\n        this.gsap.to(this, {skewing: this.options.skewing});\r\n    }\r\n\r\n    /**\r\n     * Stick cursor to the element.\r\n     *\r\n     * @param {string|HTMLElement} element Element or selector.\r\n     */\r\n    setStick(element) {\r\n        const el = typeof (element) === 'string' ? document.querySelector(element) : element;\r\n        const rect = el.getBoundingClientRect();\r\n        this.stick = {\r\n            y: rect.top + (rect.height / 2),\r\n            x: rect.left + (rect.width / 2),\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Unstick cursor from the element.\r\n     */\r\n    removeStick() {\r\n        this.stick = false;\r\n    }\r\n\r\n    /**\r\n     * Transform cursor to text mode with a given string.\r\n     *\r\n     * @param {string} text Text.\r\n     */\r\n    setText(text) {\r\n        this.text.innerHTML = text;\r\n        this.addState(this.options.textState);\r\n        this.setSkewing(this.options.skewingText);\r\n    }\r\n\r\n    /**\r\n     * Reverts cursor from text mode.\r\n     */\r\n    removeText() {\r\n        this.removeState(this.options.textState);\r\n        this.removeSkewing();\r\n    }\r\n\r\n    /**\r\n     * Transform cursor to svg icon mode.\r\n     *\r\n     * @param {string} name Icon identifier.\r\n     * @param {string} [style=\"\"] Additional SVG styles.\r\n     */\r\n    setIcon(name, style = '') {\r\n        this.text.innerHTML = `<svg class='${this.options.iconSvgClassName} ${this.options.iconSvgNamePrefix}${name}'`\r\n            + ` style='${style}'><use xlink:href='${this.options.iconSvgSrc}#${name}'></use></svg>`;\r\n        this.addState(this.options.iconState);\r\n        this.setSkewing(this.options.skewingIcon);\r\n    }\r\n\r\n    /**\r\n     * Reverts cursor from icon mode.\r\n     */\r\n    removeIcon() {\r\n        this.removeState(this.options.iconState);\r\n        this.removeSkewing();\r\n    }\r\n\r\n    /**\r\n     * Transform cursor to media mode with a given element.\r\n     *\r\n     * @param {HTMLElement} element Element.\r\n     */\r\n    setMedia(element) {\r\n        clearTimeout(this.mediaInt);\r\n        if (element) {\r\n            this.mediaBox.innerHTML = '';\r\n            this.mediaBox.appendChild(element);\r\n        }\r\n        this.mediaInt = setTimeout(() => this.addState(this.options.mediaState), 20);\r\n        this.setSkewing(this.options.skewingMedia);\r\n    }\r\n\r\n    /**\r\n     * Revert cursor from media mode.\r\n     */\r\n    removeMedia() {\r\n        clearTimeout(this.mediaInt);\r\n        this.removeState(this.options.mediaState);\r\n        this.mediaInt = setTimeout(() => this.mediaBox.innerHTML = '', this.options.hideMediaTimeout);\r\n        this.removeSkewing();\r\n    }\r\n\r\n    /**\r\n     * Transform cursor to image mode.\r\n     *\r\n     * @param {string} url Image url.\r\n     */\r\n    setImg(url) {\r\n        if (!this.mediaImg) this.mediaImg = new Image();\r\n        if (this.mediaImg.src !== url) this.mediaImg.src = url;\r\n        this.setMedia(this.mediaImg);\r\n    }\r\n\r\n    /**\r\n     * Reverts cursor from image mode.\r\n     */\r\n    removeImg() {\r\n        this.removeMedia();\r\n    }\r\n\r\n    /**\r\n     * Transform cursor to video mode.\r\n     *\r\n     * @param {string} url Video url.\r\n     */\r\n    setVideo(url) {\r\n        if (!this.mediaVideo) {\r\n            this.mediaVideo = document.createElement('video');\r\n            this.mediaVideo.muted = true;\r\n            this.mediaVideo.loop = true;\r\n            this.mediaVideo.autoplay = true;\r\n        }\r\n        if (this.mediaVideo.src !== url) {\r\n            this.mediaVideo.src = url;\r\n            this.mediaVideo.load();\r\n        }\r\n        this.mediaVideo.play();\r\n        this.setMedia(this.mediaVideo);\r\n    }\r\n\r\n    /**\r\n     * Reverts cursor from video mode.\r\n     */\r\n    removeVideo() {\r\n        if (this.mediaVideo && this.mediaVideo.readyState > 2) this.mediaVideo.pause();\r\n        this.removeMedia();\r\n    }\r\n\r\n    /**\r\n     * Attach an event handler function.\r\n     *\r\n     * @param {string} event Event name.\r\n     * @param {function} callback Callback.\r\n     */\r\n    on(event, callback) {\r\n        if (!(this.events[event] instanceof Array)) this.off(event);\r\n        this.events[event].push(callback);\r\n    }\r\n\r\n    /**\r\n     * Remove an event handler.\r\n     *\r\n     * @param {string} event Event name.\r\n     * @param {function} [callback] Callback.\r\n     */\r\n    off(event, callback) {\r\n        if (callback) {\r\n            this.events[event] = this.events[event].filter((f) => f !== callback);\r\n        } else {\r\n            this.events[event] = [];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Execute all handlers for the given event type.\r\n     *\r\n     * @param {string} event Event name.\r\n     * @param params Extra parameters.\r\n     */\r\n    trigger(event, ...params) {\r\n        if (!this.events[event]) return;\r\n        this.events[event].forEach((f) => f.call(this, this, ...params));\r\n    }\r\n\r\n    /**\r\n     * Get cursor options from data attribute of a given element.\r\n     *\r\n     * @param {HTMLElement} element Element.\r\n     * @return {Object} Options.\r\n     */\r\n    getFromDataset(element) {\r\n        const dataset = element.dataset;\r\n        return {\r\n            state: dataset[this.options.dataAttr],\r\n            show: dataset[this.options.dataAttr + 'Show'],\r\n            text: dataset[this.options.dataAttr + 'Text'],\r\n            icon: dataset[this.options.dataAttr + 'Icon'],\r\n            img: dataset[this.options.dataAttr + 'Img'],\r\n            video: dataset[this.options.dataAttr + 'Video'],\r\n            stick: dataset[this.options.dataAttr + 'Stick'],\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Destroy cursor instance.\r\n     */\r\n    destroy() {\r\n        this.trigger('destroy');\r\n        this.gsap.ticker.remove(this.ticker);\r\n        this.container.removeEventListener('mouseleave', this.event.mouseleave);\r\n        this.container.removeEventListener('mouseenter', this.event.mouseenter);\r\n        this.container.removeEventListener('mousedown', this.event.mousedown);\r\n        this.container.removeEventListener('mouseup', this.event.mouseup);\r\n        this.container.removeEventListener('mousemove', this.event.mousemove);\r\n        this.container.removeEventListener('mousemove', this.event.mousemoveOnce);\r\n        this.container.removeEventListener('mouseover', this.event.mouseover);\r\n        this.container.removeEventListener('mouseout', this.event.mouseout);\r\n        if (this.el) {\r\n            this.container.removeChild(this.el);\r\n            this.el = null;\r\n            this.mediaImg = null;\r\n            this.mediaVideo = null;\r\n        }\r\n    }\r\n}\r\n"],"names":["MouseFollower","options","this","Object","assign","el","container","document","body","className","innerClassName","textClassName","mediaClassName","mediaBoxClassName","iconSvgClassName","iconSvgNamePrefix","iconSvgSrc","dataAttr","hiddenState","textState","iconState","activeState","mediaState","stateDetection","visible","visibleOnState","speed","ease","overwrite","skewing","skewingText","skewingIcon","skewingMedia","skewingDelta","skewingDeltaMax","stickDelta","showTimeout","hideOnLeave","hideTimeout","hideMediaTimeout","initialPos","window","innerWidth","innerHeight","gsap","querySelector","pos","x","y","vel","event","events","init","registerGSAP","_proto","prototype","create","createSetter","bind","render","ticker","add","createElement","classList","inner","text","media","mediaBox","appendChild","setter","quickSetter","rotation","scaleX","scaleY","wc","_this","mouseleave","hide","mouseenter","show","mousedown","addState","mouseup","removeState","mousemoveOnce","mousemove","e","to","stick","clientX","clientY","duration","onUpdate","mouseover","target","relatedTarget","contains","parentNode","state","matches","params","getFromDataset","setText","icon","setIcon","img","setImg","video","setVideo","setStick","mouseout","removeText","removeIcon","removeImg","removeVideo","removeStick","addEventListener","passive","once","force","trigger","distance","Math","sqrt","pow","scale","min","angle","atan2","PI","_this2","clearInterval","visibleInt","setTimeout","remove","_this3","toggle","_this$el$classList","apply","split","_this$el$classList2","toggleState","setSkewing","value","removeSkewing","element","rect","getBoundingClientRect","top","height","left","width","innerHTML","name","style","setMedia","_this4","clearTimeout","mediaInt","removeMedia","_this5","url","mediaImg","Image","src","mediaVideo","muted","loop","autoplay","load","play","readyState","pause","on","callback","Array","off","push","filter","f","_arguments","arguments","_this6","forEach","call","concat","slice","dataset","destroy","removeEventListener","removeChild"],"mappings":"gOAQqBA,IAAAA,0BAoDjB,SAAAA,EAAYC,QAAO,IAAPA,IAAAA,EAAU,CAAA,GAElBC,KAAKD,QAAUE,OAAOC,OAAO,CAAA,EAAI,CAC7BC,GAAI,KACJC,UAAWC,SAASC,KACpBC,UAAW,YACXC,eAAgB,kBAChBC,cAAe,iBACfC,eAAgB,kBAChBC,kBAAmB,sBACnBC,iBAAkB,eAClBC,kBAAmB,IACnBC,WAAY,GACZC,SAAU,SACVC,YAAa,UACbC,UAAW,QACXC,UAAW,QACXC,YAAa,UACbC,WAAY,SACZC,eAAgB,CACZ,WAAY,YAEhBC,SAAS,EACTC,gBAAgB,EAChBC,MAAO,IACPC,KAAM,WACNC,WAAW,EACXC,QAAS,EACTC,YAAa,EACbC,YAAa,EACbC,aAAc,EACdC,aAAc,KACdC,gBAAiB,IACjBC,WAAY,IACZC,YAAa,EACbC,aAAa,EACbC,YAAa,IACbC,iBAAkB,IAClBC,WAAY,EAAEC,OAAOC,YAAaD,OAAOE,cAC1C1C,GAECC,KAAKD,QAAQuB,SAAqC,MAA1BvB,EAAQsB,iBAAwBrB,KAAKD,QAAQsB,eAAe,WAAa,UAErGrB,KAAK0C,KAAO5C,EAAc4C,MAAQH,OAAOG,KACzC1C,KAAKG,GAAkC,iBAArBH,KAAKD,QAAQI,GAC3BE,SAASsC,cAAc3C,KAAKD,QAAQI,IAAMH,KAAKD,QAAQI,GAC3DH,KAAKI,UAAgD,sBAAvBL,QAAQK,UAClCC,SAASsC,cAAc3C,KAAKD,QAAQK,WAAaJ,KAAKD,QAAQK,UAClEJ,KAAK2B,QAAU3B,KAAKD,QAAQ4B,QAC5B3B,KAAK4C,IAAM,CAACC,EAAG7C,KAAKD,QAAQuC,WAAW,GAAIQ,EAAG9C,KAAKD,QAAQuC,WAAW,IACtEtC,KAAK+C,IAAM,CAACF,EAAG,EAAGC,EAAG,GACrB9C,KAAKgD,MAAQ,CAAE,EACfhD,KAAKiD,OAAS,GAEdjD,KAAKkD,MACT,CAACpD,EAhEMqD,aAAP,SAAoBT,GAChB5C,EAAc4C,KAAOA,CACzB,EAACU,IAAAA,EAAAtD,EAAAuD,iBAAAD,EAmEDF,KAAA,WACSlD,KAAKG,IAAIH,KAAKsD,SACnBtD,KAAKuD,eACLvD,KAAKwD,OACLxD,KAAKyD,QAAO,GACZzD,KAAK0D,OAAS1D,KAAKyD,OAAOD,KAAKxD,MAAM,GACrCA,KAAK0C,KAAKgB,OAAOC,IAAI3D,KAAK0D,OAC9B,EAACN,EAKDE,OAAA,WACItD,KAAKG,GAAKE,SAASuD,cAAc,OACjC5D,KAAKG,GAAGI,UAAYP,KAAKD,QAAQQ,UACjCP,KAAKG,GAAG0D,UAAUF,IAAI3D,KAAKD,QAAQiB,aAEnChB,KAAK8D,MAAQzD,SAASuD,cAAc,OACpC5D,KAAK8D,MAAMvD,UAAYP,KAAKD,QAAQS,eAEpCR,KAAK+D,KAAO1D,SAASuD,cAAc,OACnC5D,KAAK+D,KAAKxD,UAAYP,KAAKD,QAAQU,cAEnCT,KAAKgE,MAAQ3D,SAASuD,cAAc,OACpC5D,KAAKgE,MAAMzD,UAAYP,KAAKD,QAAQW,eAEpCV,KAAKiE,SAAW5D,SAASuD,cAAc,OACvC5D,KAAKiE,SAAS1D,UAAYP,KAAKD,QAAQY,kBAEvCX,KAAKgE,MAAME,YAAYlE,KAAKiE,UAC5BjE,KAAK8D,MAAMI,YAAYlE,KAAKgE,OAC5BhE,KAAK8D,MAAMI,YAAYlE,KAAK+D,MAC5B/D,KAAKG,GAAG+D,YAAYlE,KAAK8D,OACzB9D,KAAKI,UAAU8D,YAAYlE,KAAKG,GACpC,EAACiD,EAKDG,aAAA,WACIvD,KAAKmE,OAAS,CACVtB,EAAG7C,KAAK0C,KAAK0B,YAAYpE,KAAKG,GAAI,IAAK,MACvC2C,EAAG9C,KAAK0C,KAAK0B,YAAYpE,KAAKG,GAAI,IAAK,MACvCkE,SAAUrE,KAAK0C,KAAK0B,YAAYpE,KAAKG,GAAI,WAAY,OACrDmE,OAAQtE,KAAK0C,KAAK0B,YAAYpE,KAAKG,GAAI,UACvCoE,OAAQvE,KAAK0C,KAAK0B,YAAYpE,KAAKG,GAAI,UACvCqE,GAAIxE,KAAK0C,KAAK0B,YAAYpE,KAAKG,GAAI,cACnC2D,MAAO,CACHO,SAAUrE,KAAK0C,KAAK0B,YAAYpE,KAAK8D,MAAO,WAAY,QAGpE,EAACV,EAKDI,KAAA,eAAOiB,EAAAzE,KACHA,KAAKgD,MAAM0B,WAAa,WAAA,OAAMD,EAAKE,MAAM,EACzC3E,KAAKgD,MAAM4B,WAAa,kBAAMH,EAAKI,MAAM,EACzC7E,KAAKgD,MAAM8B,UAAY,WAAM,OAAAL,EAAKM,SAASN,EAAK1E,QAAQoB,YAAY,EACpEnB,KAAKgD,MAAMgC,QAAU,WAAM,OAAAP,EAAKQ,YAAYR,EAAK1E,QAAQoB,YAAY,EACrEnB,KAAKgD,MAAMkC,cAAgB,WAAA,OAAMT,EAAKI,MAAM,EAC5C7E,KAAKgD,MAAMmC,UAAY,SAACC,GACpBX,EAAK/B,KAAK2C,GAAGZ,EAAK7B,IAAK,CACnBC,EAAG4B,EAAKa,MAAQb,EAAKa,MAAMzC,GAAM4B,EAAKa,MAAMzC,EAAIuC,EAAEG,SAAWd,EAAK1E,QAAQkC,WAAcmD,EAAEG,QAC1FzC,EAAG2B,EAAKa,MAAQb,EAAKa,MAAMxC,GAAM2B,EAAKa,MAAMxC,EAAIsC,EAAEI,SAAWf,EAAK1E,QAAQkC,WAAcmD,EAAEI,QAC1F9D,UAAW+C,EAAK1E,QAAQ2B,UACxBD,KAAMgD,EAAK1E,QAAQ0B,KACnBgE,SAAUhB,EAAKnD,QAAUmD,EAAK1E,QAAQyB,MAAQ,EAC9CkE,SAAU,WAAF,OAAQjB,EAAK1B,IAAM,CAACF,EAAGuC,EAAEG,QAAUd,EAAK7B,IAAIC,EAAGC,EAAGsC,EAAEI,QAAUf,EAAK7B,IAAIE,EAAE,GAEzF,EACA9C,KAAKgD,MAAM2C,UAAY,SAACP,GACpB,IAAK,IAAIQ,EAASR,EAAEQ,OAAQA,GAAUA,IAAWnB,EAAKrE,aAC9CgF,EAAES,gBAAiBD,EAAOE,SAASV,EAAES,gBADoBD,EAASA,EAAOG,WAAY,CAGzF,IAAK,IAAIC,KAASvB,EAAK1E,QAAQsB,eACvBuE,EAAOK,QAAQxB,EAAK1E,QAAQsB,eAAe2E,KAASvB,EAAKM,SAASiB,GAG1E,GAAIvB,EAAK1E,QAAQgB,SAAU,CACvB,IAAMmF,EAASzB,EAAK0B,eAAeP,GAC/BM,EAAOF,OAAOvB,EAAKM,SAASmB,EAAOF,OACnCE,EAAOnC,MAAMU,EAAK2B,QAAQF,EAAOnC,MACjCmC,EAAOG,MAAM5B,EAAK6B,QAAQJ,EAAOG,MACjCH,EAAOK,KAAK9B,EAAK+B,OAAON,EAAOK,KAC/BL,EAAOO,OAAOhC,EAAKiC,SAASR,EAAOO,YACV,IAAjBP,EAAOrB,MAAuBJ,EAAKI,YACjB,IAAlBqB,EAAOZ,OAAwBb,EAAKkC,SAAST,EAAOZ,OAASM,EAC7E,CACJ,CACJ,EACA5F,KAAKgD,MAAM4D,SAAW,SAACxB,GACnB,IAAK,IAAIQ,EAASR,EAAEQ,OAAQA,GAAUA,IAAWnB,EAAKrE,aAC9CgF,EAAES,gBAAiBD,EAAOE,SAASV,EAAES,gBADoBD,EAASA,EAAOG,WAAY,CAGzF,IAAK,IAAIC,KAASvB,EAAK1E,QAAQsB,eACvBuE,EAAOK,QAAQxB,EAAK1E,QAAQsB,eAAe2E,KAASvB,EAAKQ,YAAYe,GAG7E,GAAIvB,EAAK1E,QAAQgB,SAAU,CACvB,IAAMmF,EAASzB,EAAK0B,eAAeP,GAC/BM,EAAOF,OAAOvB,EAAKQ,YAAYiB,EAAOF,OACtCE,EAAOnC,MAAMU,EAAKoC,aAClBX,EAAOG,MAAM5B,EAAKqC,aAClBZ,EAAOK,KAAK9B,EAAKsC,YACjBb,EAAOO,OAAOhC,EAAKuC,mBACM,IAAjBd,EAAOrB,MAAuBJ,EAAKE,YACjB,IAAlBuB,EAAOZ,OAAwBb,EAAKwC,aACpD,CACJ,CACJ,EAEIjH,KAAKD,QAAQoC,aACbnC,KAAKI,UAAU8G,iBAAiB,aAAclH,KAAKgD,MAAM0B,WAAY,CAACyC,SAAS,IAE/EnH,KAAKD,QAAQuB,SACbtB,KAAKI,UAAU8G,iBAAiB,aAAclH,KAAKgD,MAAM4B,WAAY,CAACuC,SAAS,IAE/EnH,KAAKD,QAAQoB,cACbnB,KAAKI,UAAU8G,iBAAiB,YAAalH,KAAKgD,MAAM8B,UAAW,CAACqC,SAAS,IAC7EnH,KAAKI,UAAU8G,iBAAiB,UAAWlH,KAAKgD,MAAMgC,QAAS,CAACmC,SAAS,KAE7EnH,KAAKI,UAAU8G,iBAAiB,YAAalH,KAAKgD,MAAMmC,UAAW,CAACgC,SAAS,IACzEnH,KAAKD,QAAQuB,SACbtB,KAAKI,UAAU8G,iBAAiB,YAAalH,KAAKgD,MAAMkC,cAAe,CACnEiC,SAAS,EACTC,MAAM,KAGVpH,KAAKD,QAAQsB,gBAAkBrB,KAAKD,QAAQgB,YAC5Cf,KAAKI,UAAU8G,iBAAiB,YAAalH,KAAKgD,MAAM2C,UAAW,CAACwB,SAAS,IAC7EnH,KAAKI,UAAU8G,iBAAiB,WAAYlH,KAAKgD,MAAM4D,SAAU,CAACO,SAAS,IAEnF,EAAC/D,EAODK,OAAA,SAAO4D,GACH,IAAc,IAAVA,GAAkC,IAAfrH,KAAK+C,IAAID,GAA0B,IAAf9C,KAAK+C,IAAIF,GAUpD,GALA7C,KAAKsH,QAAQ,UACbtH,KAAKmE,OAAOK,GAAG,aACfxE,KAAKmE,OAAOtB,EAAE7C,KAAK4C,IAAIC,GACvB7C,KAAKmE,OAAOrB,EAAE9C,KAAK4C,IAAIE,GAEnB9C,KAAK2B,QAAS,CACd,IAAM4F,EAAWC,KAAKC,KAAKD,KAAKE,IAAI1H,KAAK+C,IAAIF,EAAG,GAAK2E,KAAKE,IAAI1H,KAAK+C,IAAID,EAAG,IACpE6E,EAAQH,KAAKI,IAAIL,EAAWvH,KAAKD,QAAQgC,aAC3C/B,KAAKD,QAAQiC,iBAAmBhC,KAAK2B,QACnCkG,EAA6C,IAArCL,KAAKM,MAAM9H,KAAK+C,IAAID,EAAG9C,KAAK+C,IAAIF,GAAW2E,KAAKO,GAE9D/H,KAAKmE,OAAOE,SAASwD,GACrB7H,KAAKmE,OAAOG,OAAO,EAAIqD,GACvB3H,KAAKmE,OAAOI,OAAO,EAAIoD,GACvB3H,KAAKmE,OAAOL,MAAMO,UAAUwD,EAChC,OAnBI7H,KAAKmE,OAAOK,GAAG,OAoBvB,EAACpB,EAKDyB,KAAA,WAAO,IAAAmD,EAAAhI,KACHA,KAAKsH,QAAQ,QACbW,cAAcjI,KAAKkI,YACnBlI,KAAKkI,WAAaC,WAAW,WACzBH,EAAK7H,GAAG0D,UAAUuE,OAAOJ,EAAKjI,QAAQiB,aACtCgH,EAAK1G,SAAU,EACf0G,EAAKvE,QAAO,EAChB,EAAGzD,KAAKD,QAAQmC,YACpB,EAACkB,EAKDuB,KAAA,WAAO,IAAA0D,EAAArI,KACHA,KAAKsH,QAAQ,QACbW,cAAcjI,KAAKkI,YACnBlI,KAAKG,GAAG0D,UAAUF,IAAI3D,KAAKD,QAAQiB,aACnChB,KAAKkI,WAAaC,WAAW,kBAAME,EAAK/G,SAAU,CAAK,EAAEtB,KAAKD,QAAQqC,YAC1E,EAACgB,EAODkF,OAAA,SAAOjB,IACW,IAAVA,IAA4B,IAAVA,IAAoBrH,KAAKsB,QAC3CtB,KAAK6E,OAEL7E,KAAK2E,MAEb,EAACvB,EAOD2B,SAAA,SAASiB,GAAOuC,IAAAA,EAEZ,GADAvI,KAAKsH,QAAQ,WAAYtB,GACrBA,IAAUhG,KAAKD,QAAQiB,YAAa,YAAY2D,QACpD4D,EAAIvI,KAACG,GAAG0D,WAAUF,IAAG6E,MAAAD,EAAIvC,EAAMyC,MAAM,MACjCzI,KAAKD,QAAQwB,gBAAgBvB,KAAK6E,MAC1C,EAACzB,EAOD6B,YAAA,SAAYe,GAAO0C,IAAAA,EAEf,GADA1I,KAAKsH,QAAQ,cAAetB,GACxBA,IAAUhG,KAAKD,QAAQiB,YAAa,OAAOhB,KAAK6E,QACpD6D,EAAA1I,KAAKG,GAAG0D,WAAUuE,OAAMI,MAAAE,EAAI1C,EAAMyC,MAAM,MACpCzI,KAAKD,QAAQwB,gBAAkBvB,KAAKG,GAAGI,YAAcP,KAAKD,QAAQQ,WAAWP,KAAK2E,MAC1F,EAACvB,EAQDuF,YAAA,SAAY3C,EAAOqB,IACD,IAAVA,IAA4B,IAAVA,IAAoBrH,KAAKG,GAAG0D,UAAUiC,SAASE,GACjEhG,KAAK+E,SAASiB,GAEdhG,KAAKiF,YAAYe,EAEzB,EAAC5C,EAODwF,WAAA,SAAWC,GACP7I,KAAK0C,KAAK2C,GAAGrF,KAAM,CAAC2B,QAASkH,GACjC,EAACzF,EAKD0F,cAAA,WACI9I,KAAK0C,KAAK2C,GAAGrF,KAAM,CAAC2B,QAAS3B,KAAKD,QAAQ4B,SAC9C,EAACyB,EAODuD,SAAA,SAASoC,GACL,IACMC,GAD0B,iBAAbD,EAAwB1I,SAASsC,cAAcoG,GAAWA,GAC7DE,wBAChBjJ,KAAKsF,MAAQ,CACTxC,EAAGkG,EAAKE,IAAOF,EAAKG,OAAS,EAC7BtG,EAAGmG,EAAKI,KAAQJ,EAAKK,MAAQ,EAErC,EAACjG,EAKD6D,YAAA,WACIjH,KAAKsF,OAAQ,CACjB,EAAClC,EAODgD,QAAA,SAAQrC,GACJ/D,KAAK+D,KAAKuF,UAAYvF,EACtB/D,KAAK+E,SAAS/E,KAAKD,QAAQkB,WAC3BjB,KAAK4I,WAAW5I,KAAKD,QAAQ6B,YACjC,EAACwB,EAKDyD,WAAA,WACI7G,KAAKiF,YAAYjF,KAAKD,QAAQkB,WAC9BjB,KAAK8I,eACT,EAAC1F,EAQDkD,QAAA,SAAQiD,EAAMC,QAAAA,IAAAA,IAAAA,EAAQ,IAClBxJ,KAAK+D,KAAKuF,UAAY,eAAetJ,KAAKD,QAAQa,qBAAoBZ,KAAKD,QAAQc,kBAAoB0I,EAAjF,YACLC,EAAK,sBAAsBxJ,KAAKD,QAAQe,WAAcyI,IAAAA,EAAoB,iBAC3FvJ,KAAK+E,SAAS/E,KAAKD,QAAQmB,WAC3BlB,KAAK4I,WAAW5I,KAAKD,QAAQ8B,YACjC,EAACuB,EAKD0D,WAAA,WACI9G,KAAKiF,YAAYjF,KAAKD,QAAQmB,WAC9BlB,KAAK8I,eACT,EAAC1F,EAODqG,SAAA,SAASV,OAASW,EAAA1J,KACd2J,aAAa3J,KAAK4J,UACdb,IACA/I,KAAKiE,SAASqF,UAAY,GAC1BtJ,KAAKiE,SAASC,YAAY6E,IAE9B/I,KAAK4J,SAAWzB,WAAW,WAAM,OAAAuB,EAAK3E,SAAS2E,EAAK3J,QAAQqB,WAAW,EAAE,IACzEpB,KAAK4I,WAAW5I,KAAKD,QAAQ+B,aACjC,EAACsB,EAKDyG,YAAA,WAAcC,IAAAA,EACVH,KAAAA,aAAa3J,KAAK4J,UAClB5J,KAAKiF,YAAYjF,KAAKD,QAAQqB,YAC9BpB,KAAK4J,SAAWzB,WAAW,WAAA,OAAM2B,EAAK7F,SAASqF,UAAY,EAAE,EAAEtJ,KAAKD,QAAQsC,kBAC5ErC,KAAK8I,eACT,EAAC1F,EAODoD,OAAA,SAAOuD,GACE/J,KAAKgK,WAAUhK,KAAKgK,SAAW,IAAIC,OACpCjK,KAAKgK,SAASE,MAAQH,IAAK/J,KAAKgK,SAASE,IAAMH,GACnD/J,KAAKyJ,SAASzJ,KAAKgK,SACvB,EAAC5G,EAKD2D,UAAA,WACI/G,KAAK6J,aACT,EAACzG,EAODsD,SAAA,SAASqD,GACA/J,KAAKmK,aACNnK,KAAKmK,WAAa9J,SAASuD,cAAc,SACzC5D,KAAKmK,WAAWC,OAAQ,EACxBpK,KAAKmK,WAAWE,MAAO,EACvBrK,KAAKmK,WAAWG,UAAW,GAE3BtK,KAAKmK,WAAWD,MAAQH,IACxB/J,KAAKmK,WAAWD,IAAMH,EACtB/J,KAAKmK,WAAWI,QAEpBvK,KAAKmK,WAAWK,OAChBxK,KAAKyJ,SAASzJ,KAAKmK,WACvB,EAAC/G,EAKD4D,YAAA,WACQhH,KAAKmK,YAAcnK,KAAKmK,WAAWM,WAAa,GAAGzK,KAAKmK,WAAWO,QACvE1K,KAAK6J,aACT,EAACzG,EAQDuH,GAAA,SAAG3H,EAAO4H,GACA5K,KAAKiD,OAAOD,aAAkB6H,OAAQ7K,KAAK8K,IAAI9H,GACrDhD,KAAKiD,OAAOD,GAAO+H,KAAKH,EAC5B,EAACxH,EAQD0H,IAAA,SAAI9H,EAAO4H,GAEH5K,KAAKiD,OAAOD,GADZ4H,EACqB5K,KAAKiD,OAAOD,GAAOgI,OAAO,SAACC,GAAM,OAAAA,IAAML,CAAQ,GAE/C,EAE7B,EAACxH,EAQDkE,QAAA,SAAQtE,GAAkB,IAAAkI,EAAAC,UAAAC,EAAApL,KACjBA,KAAKiD,OAAOD,IACjBhD,KAAKiD,OAAOD,GAAOqI,QAAQ,SAACJ,GAAM,OAAAA,EAAEK,KAAI9C,MAANyC,EAAOG,CAAAA,EAAMA,GAAIG,OAAA,GAAAC,MAAAF,KAAAJ,EAAA,IAAY,EACnE,EAAC9H,EAQD+C,eAAA,SAAe4C,GACX,IAAM0C,EAAU1C,EAAQ0C,QACxB,MAAO,CACHzF,MAAOyF,EAAQzL,KAAKD,QAAQgB,UAC5B8D,KAAM4G,EAAQzL,KAAKD,QAAQgB,SAAW,QACtCgD,KAAM0H,EAAQzL,KAAKD,QAAQgB,SAAW,QACtCsF,KAAMoF,EAAQzL,KAAKD,QAAQgB,SAAW,QACtCwF,IAAKkF,EAAQzL,KAAKD,QAAQgB,SAAW,OACrC0F,MAAOgF,EAAQzL,KAAKD,QAAQgB,SAAW,SACvCuE,MAAOmG,EAAQzL,KAAKD,QAAQgB,SAAW,SAE/C,EAACqC,EAKDsI,QAAA,WACI1L,KAAKsH,QAAQ,WACbtH,KAAK0C,KAAKgB,OAAO0E,OAAOpI,KAAK0D,QAC7B1D,KAAKI,UAAUuL,oBAAoB,aAAc3L,KAAKgD,MAAM0B,YAC5D1E,KAAKI,UAAUuL,oBAAoB,aAAc3L,KAAKgD,MAAM4B,YAC5D5E,KAAKI,UAAUuL,oBAAoB,YAAa3L,KAAKgD,MAAM8B,WAC3D9E,KAAKI,UAAUuL,oBAAoB,UAAW3L,KAAKgD,MAAMgC,SACzDhF,KAAKI,UAAUuL,oBAAoB,YAAa3L,KAAKgD,MAAMmC,WAC3DnF,KAAKI,UAAUuL,oBAAoB,YAAa3L,KAAKgD,MAAMkC,eAC3DlF,KAAKI,UAAUuL,oBAAoB,YAAa3L,KAAKgD,MAAM2C,WAC3D3F,KAAKI,UAAUuL,oBAAoB,WAAY3L,KAAKgD,MAAM4D,UACtD5G,KAAKG,KACLH,KAAKI,UAAUwL,YAAY5L,KAAKG,IAChCH,KAAKG,GAAK,KACVH,KAAKgK,SAAW,KAChBhK,KAAKmK,WAAa,KAE1B,EAACrK,CAAA"}